os: osx
language: node_js
node_js: node
python:
  - 3.5
cache:
  - pip
  - npm
before_install:
  - pip install awscli
after_success:
  - cd example
  - npm install
  - npm run build
deploy:
  provider: s3
  region: us-west-2
  access_key_id: AKIAJLF73MKGDJEKZVGQ
  secret_access_key:
    secure: I2yQmNFDbzLePWb9XTVgQVMfE5y2SczjrwWZ64guMzlJe1uJ1uXcyHc1IC19z1RgSg+WfxyOXJycRTOQ6JP2l4RdFMkPpyAfv1ooQbfIxwyejxxiciuZvKdxp/+wIDwIC3TPCiaTd7JKmpHxC9M+Y+I96I7AAIJc41Tsx0Kwu6TDmBpQC5RRhHFJeJGz1VmHM2KwVHK/g99C3d/hFJdu7lyG2gjkLIbBKMvw3ublY9jwOUvXoZf98prOS7xl0qLKY5vEIx1EvsP4pMxOQftGapR0RUtGlVI8nj6m4qPcT76WrwLFBH4sTcVhwMngiPAlhEHlzB4BZCE8iQSaLkcXi3SiBuG+UYBjpz7Y9hiSxHKWlYU5EmwdZpqXalBrGpeAi4gXuuIiNmQaINnOD9SpGkBgSBCLV6FU2oxlSXCyCrv8D/SdEB0Bh1sOjX2LwYqdq7hxRlkykJj2dqjKm1qnCbtsNXzVykrGuYayfFpWKLUtqgdayJiprgj0TCekLrlkEI258hvkeLVZMGPtwuU1jXF7QEHUs12eaOXdNwjxRKWlaBVxrdTvh6eM3izOWHMy/cC3TXuYXoP6b32GFTw9l3/kRm3GbCNCRVWRTfUfvgVclJKnueGTXddJy721T2rKnTt13+ivjlcwQXdqiwwtRFAMyH/2rB6JIEUG2hj1/EE=
  bucket: transform-css
  local_dir: dist
  upload-dir: "$TRAVIS_BRANCH"
  skip_cleanup: true
after_deploy:
  - aws configure set preview.cloudfront true
  - aws configure set preview.create-invalidation true
  - aws cloudfront create-invalidation --cli-input-json "{\"DistributionId\":\"$AWS_CLOUDFRONT_ID\",\"InvalidationBatch\":{\"Paths\":{\"Quantity\":2,\"Items\":[\"/index.html\",\"/*\"]},\"CallerReference\":\"$(date+%s)\"}}"
